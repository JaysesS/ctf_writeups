import Crypto.Util.number
import math
import random


def generate_rsa_public_key():
    while True:
        p = Crypto.Util.number.getPrime(1024)
        q = Crypto.Util.number.getPrime(1024)
        n = p * q

        e = Crypto.Util.number.getPrime(2047)

        if e < n:
            return n, e


def encrypt_rsa(c, n, e):
    # fix to exponentiation
    return (c ^ e) % n


n, e = generate_rsa_public_key()

with open("flag.txt", "r") as f:
    flag = f.read()

message = Crypto.Util.number.bytes_to_long(flag.encode())

print("n =", n)
print("e =", e)
print("encrypted =", encrypt_rsa(message, n, e))

# n = 18387483530373483201733626726114616143223953152603811793499835725813713934658560128915283491898820478633308587399846051368301650511288916915910368358774847234257604984423603482299620091373653733375416075389403667220873217026751889192471487407437116242998657401690109556809857817435058336775384794298036560710689445334291337270758358318594920145820865523915078968717033379856065022641504925348930784331937921556815351999503262694860039206869646131427124585875749982397425365638326503587447745396644508558688750260192635967927093573300865190111151903926278306218844648038454097563808510369162639968064652194231240066293
# e = 15512201287745852038603936169050955403169544350874409209425324091337559728142130941917715868255008400100378767867505974138378667993725678750918409600244379564273154544512774957479278694007877369959605149132157949348594043560405555790828215374347293416070139948474247078250063729732264812528353032697888309326189506132622807146086751368274335281227178255730167464610904545096303373597121558146806275246748166500173193826111848485878526451119732991888475196131101119362043292723765860947707787374285558546717861782902941943605197597467441386823198717878062053085055347606494800556541417657664718312795466775971032669921
# encrypted = 15475142924581259418826141415911810601635896517174245259469307850380062251208493693227347310033652620482877556008172006949875395297855004717060323815712905488514407435927760144518477961491239085179460021539534107651652519199307487601345811082469117499768902939608647562549021044445795487407905119907243573912625173100774270433442572510825990344532054112119117401596133049983668886036247069511277047026084441367654483879980906942666701540377419198323041830800036462355195102402750795780269944360718028534276189610874670396693786075015558420543480277911880831756510736370362015173698327282764591196354967937692140200939